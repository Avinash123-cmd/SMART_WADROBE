<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Cloth - AI Smart Wardrobe</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <a href="/dashboard" class="text-2xl font-bold text-purple-600">
                    <i class="fas fa-tshirt mr-2"></i>Smart Wardrobe
                </a>
                <div class="flex items-center space-x-6">
                    <a href="/dashboard" class="text-gray-600 hover:text-purple-600">
                        <i class="fas fa-home mr-1"></i>Dashboard
                    </a>
                    <a href="/wardrobe" class="text-gray-600 hover:text-purple-600">
                        <i class="fas fa-tshirt mr-1"></i>My Wardrobe
                    </a>
                    <a href="/add-cloth" class="text-purple-600 font-semibold">
                        <i class="fas fa-plus mr-1"></i>Add Cloth
                    </a>
                    <div class="flex items-center">
                        <span class="text-gray-700 mr-2">
                            <i class="fas fa-user mr-1"></i>{{ current_user.username }}
                        </span>
                        <a href="/logout" class="text-gray-600 hover:text-red-600">
                            <i class="fas fa-sign-out-alt"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8 max-w-2xl">
        <div class="mb-6">
            <h1 class="text-3xl font-bold text-gray-800">
                <i class="fas fa-plus-circle mr-2"></i>Add New Cloth
            </h1>
            <p class="text-gray-600 mt-2">
                Upload a photo of your clothing item. AI will automatically detect type and color.
            </p>
        </div>

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="mb-6 p-4 rounded-lg {% if category == 'success' %}bg-green-100 text-green-700{% else %}bg-red-100 text-red-700{% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- Upload Form -->
        <div class="bg-white rounded-xl shadow-lg p-8">
            <form method="POST" action="/add-cloth" enctype="multipart/form-data" id="cloth-form">
                <!-- Image Upload -->
                <div class="mb-8">
                    <label class="block text-gray-700 mb-4 font-semibold">
                        <i class="fas fa-image mr-2"></i>Upload Cloth Photo
                    </label>
                    
                    <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-purple-500 transition"
                         id="drop-zone">
                        <div id="preview" class="hidden mb-4">
                            <img id="preview-image" class="max-w-xs max-h-64 mx-auto rounded-lg shadow">
                        </div>
                        
                        <div id="upload-prompt">
                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-600 mb-2">Drag & drop your photo here</p>
                            <p class="text-sm text-gray-500 mb-4">or click to browse</p>
                        </div>
                        
                        <input type="file" id="image-input" name="image" accept="image/*" required
                               class="hidden" onchange="previewImage(event)">
                        
                        <label for="image-input" 
                               class="inline-block bg-purple-600 text-white px-6 py-3 rounded-lg cursor-pointer hover:bg-purple-700 transition">
                            <i class="fas fa-folder-open mr-2"></i>Choose File
                        </label>
                        
                        <p class="text-xs text-gray-500 mt-4">
                            Supported formats: JPG, PNG, GIF. Max size: 16MB
                        </p>
                    </div>
                </div>

                <!-- Cloth Details -->
                <div class="mb-6">
                    <label for="name" class="block text-gray-700 mb-2 font-semibold">
                        <i class="fas fa-tag mr-2"></i>Cloth Name
                    </label>
                    <input type="text" id="name" name="name" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"
                           placeholder="e.g., Blue Denim Jacket">
                </div>

                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <!-- Cloth Type -->
                    <div>
                        <label for="type" class="block text-gray-700 mb-2 font-semibold">
                            <i class="fas fa-tshirt mr-2"></i>Type
                        </label>
                        <select id="type" name="type" required
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent">
                            <option value="">Select type</option>
                            <option value="shirt">Shirt</option>
                            <option value="tshirt">T-Shirt</option>
                            <option value="jeans">Jeans</option>
                            <option value="pants">Pants</option>
                            <option value="jacket">Jacket</option>
                            <option value="sweater">Sweater</option>
                            <option value="dress">Dress</option>
                            <option value="skirt">Skirt</option>
                            <option value="shorts">Shorts</option>
                            <option value="shoes">Shoes</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <!-- Season -->
                    <div>
                        <label for="season" class="block text-gray-700 mb-2 font-semibold">
                            <i class="fas fa-sun mr-2"></i>Season
                        </label>
                        <select id="season" name="season" required
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent">
                            <option value="all">All Seasons</option>
                            <option value="summer">Summer</option>
                            <option value="winter">Winter</option>
                            <option value="spring">Spring</option>
                            <option value="autumn">Autumn</option>
                        </select>
                    </div>
                </div>

                <!-- Fabric -->
                <div class="mb-8">
                    <label for="fabric" class="block text-gray-700 mb-2 font-semibold">
                        <i class="fas fa-leaf mr-2"></i>Fabric
                    </label>
                    <select id="fabric" name="fabric" 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent">
                        <option value="cotton">Cotton</option>
                        <option value="denim">Denim</option>
                        <option value="wool">Wool</option>
                        <option value="silk">Silk</option>
                        <option value="polyester">Polyester</option>
                        <option value="linen">Linen</option>
                        <option value="leather">Leather</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <!-- Submit Button -->
                <div class="flex space-x-4">
                    <button type="submit"
                            class="flex-1 bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition">
                        <i class="fas fa-plus-circle mr-2"></i>Add to Wardrobe
                    </button>
                    <a href="/dashboard"
                       class="flex-1 bg-gray-200 text-gray-800 py-3 rounded-lg font-semibold text-center hover:bg-gray-300 transition">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </a>
                </div>
            </form>
        </div>

        <!-- AI Detection Info -->
        <div class="mt-8 bg-blue-50 rounded-xl p-6">
            <h3 class="text-lg font-semibold text-blue-800 mb-3">
                <i class="fas fa-robot mr-2"></i>AI Detection Features
            </h3>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="text-center">
                    <div class="text-blue-600 text-2xl mb-2">
                        <i class="fas fa-palette"></i>
                    </div>
                    <p class="text-sm font-semibold">Color Detection</p>
                    <p class="text-xs text-gray-600">AI detects dominant colors</p>
                </div>
                <div class="text-center">
                    <div class="text-blue-600 text-2xl mb-2">
                        <i class="fas fa-tag"></i>
                    </div>
                    <p class="text-sm font-semibold">Type Recognition</p>
                    <p class="text-xs text-gray-600">Identifies clothing type</p>
                </div>
                <div class="text-center">
                    <div class="text-blue-600 text-2xl mb-2">
                        <i class="fas fa-database"></i>
                    </div>
                    <p class="text-sm font-semibold">Smart Storage</p>
                    <p class="text-xs text-gray-600">Organizes in your personal wardrobe</p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Image preview
        function previewImage(event) {
            const input = event.target;
            const preview = document.getElementById('preview');
            const previewImage = document.getElementById('preview-image');
            const uploadPrompt = document.getElementById('upload-prompt');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    preview.classList.remove('hidden');
                    uploadPrompt.classList.add('hidden');
                }
                
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Drag and drop
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('image-input');

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('border-purple-500', 'bg-purple-50');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('border-purple-500', 'bg-purple-50');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('border-purple-500', 'bg-purple-50');
            
            if (e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files;
                previewImage({ target: fileInput });
            }
        });

        // Form validation
        document.getElementById('cloth-form').addEventListener('submit', function(e) {
            const imageInput = document.getElementById('image-input');
            const clothName = document.getElementById('name').value.trim();
            
            if (!imageInput.files.length) {
                e.preventDefault();
                alert('Please select an image to upload');
                return;
            }
            
            if (!clothName) {
                e.preventDefault();
                alert('Please enter a name for the clothing item');
                return;
            }
        });
    </script>
</body>
</html>